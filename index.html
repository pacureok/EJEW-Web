cat << 'EOF' > index.html
<!DOCTYPE html>
<html>
<head>
  <title>EJEW OS - Windows Environment</title>
  <style>
    body { margin: 0; overflow: hidden; background: #008080; color: #fff; font-family: 'Segoe UI', sans-serif; height: 100vh; display: flex; flex-direction: column; }
    #desktop { flex-grow: 1; position: relative; padding: 20px; }
    #taskbar { background: #c0c0c0; border-top: 2px solid #fff; height: 40px; display: flex; align-items: center; padding: 0 10px; color: #000; z-index: 100; }
    #start-btn { font-weight: bold; background: #c0c0c0; border: 2px solid; border-color: #fff #808080 #808080 #fff; padding: 2px 10px; cursor: pointer; margin-right: 10px; }
    #window-area { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; pointer-events: none; }
    #file-explorer { position: relative; background: #c0c0c0; border: 2px solid; border-color: #fff #808080 #808080 #fff; padding: 20px; color: #000; width: 400px; pointer-events: all; }
    #progress-container { width: 100%; background: #808080; height: 20px; margin-top: 10px; border: 1px solid #fff; }
    #progress-bar { width: 0%; height: 100%; background: #000080; transition: width 0.1s; }
    #log-area { background: #000; color: #0f0; font-family: monospace; font-size: 11px; height: 80px; overflow-y: auto; margin-top: 10px; padding: 5px; }
    canvas { pointer-events: all; }
  </style>
</head>
<body>
  <div id="desktop">
    <div id="window-area">
      <div id="file-explorer">
        <div style="background:#000080; color:#fff; padding:2px 5px; margin:-20px -20px 15px -20px; font-weight:bold;">EJEW - File Explorer</div>
        <p>Seleccionar carpeta del juego o .exe:</p>
        <input type="file" id="input_folder" webkitdirectory directory multiple>
        <button id="btn_run" style="margin-top:10px; width:100%;">Cargar en EJEW</button>
        <div id="progress-container"><div id="progress-bar"></div></div>
        <div id="log-area"></div>
      </div>
    </div>
  </div>
  <div id="taskbar">
    <div id="start-btn">Start</div>
    <div id="status-text" style="font-size:12px; margin-left:10px;">Sistema EJEW listo.</div>
  </div>

  <script src="ejew_wasm.js"></script>
  <script>
    const logger = (msg) => {
        const div = document.getElementById("log-area");
        div.innerHTML += `> ${msg}<br>`;
        div.scrollTop = div.scrollHeight;
    };

    window.addEventListener("message", (e) => {
        if (e.data.type === "EJEW_GPU_INIT") {
            logger("GPU: Iniciando WebGL Renderer...");
            Module._iniciar_canvas_webgl(800, 600);
        }
    });

    Module.onRuntimeInitialized = () => {
      logger("Kernel EJEW: OK");
      document.getElementById("btn_run").onclick = async () => {
        const files = document.getElementById("input_folder").files;
        if (files.length === 0) return;

        let loaded = 0;
        const total = files.length;
        document.getElementById("status-text").innerText = "Procesando archivos...";

        for (const file of files) {
          const buffer = await file.arrayBuffer();
          const uint8 = new Uint8Array(buffer);
          
          const namePtr = Module._malloc(file.name.length + 1);
          Module.writeAsciiToMemory(file.name, namePtr);
          const dataPtr = Module._malloc(uint8.length);
          Module.HEAPU8.set(uint8, dataPtr);

          Module._analizar_recurso(namePtr, dataPtr, uint8.length);

          Module._free(namePtr);
          Module._free(dataPtr);

          loaded++;
          document.getElementById("progress-bar").style.width = (loaded/total*100) + "%";
        }
        document.getElementById("status-text").innerText = "Sincronizaci√≥n completa.";
        logger("FS: Sincronizado.");
      };
    };
  </script>
</body>
</html>
EOF